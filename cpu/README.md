# FIMD-CPU: Fast Isolated Marker Detection for CPUs

This directory contains the CPU implementation of the FIMD algorithm. The universal implementation is located in the `template.c` file. This template is processed by the `generate.py` Python script to produce the final C implementation. 

CMake compiles two targets:

* `fimd_cpu` - A shared library exposing a detection function in the header file `fimd_cpu.h`. The radii must be specified in the file `CMakelists.txt` before compilation.
* `fimd_cpu_example` - An executable for testing the detection function with source code in the `example.c` file.

## Circle boundary and interior generation example
The boundary and interior points are generated by the Python script in the final evaluation order. Below is an example of verbose output for a radius of 4:

```txt
Generated Bresenham circle:
 -- Boundary points: 20
 -- Interior points: 37
Visualization:
            B10 B02 B06
        B18 I31 I13 I29 B14
    B20 I37 I23 I09 I21 I35 B16
B12 I33 I25 I17 I05 I15 I24 I32 B08
B03 I12 I08 I04 I01 I03 I07 I11 B04
B07 I28 I20 I16 I02 I14 I19 I27 B11
    B15 I36 I22 I06 I18 I34 B19
        B13 I30 I10 I26 B17
            B05 B01 B09

Pixel evaluation order:
 -- Boundary points: 20
 -- Interior points: 19
Visualization:
            B10 B02 B20
        B06             B16
    B14                     B08
B18                             B12
B04             I01 I02 I03 I04 B03
B11 I05 I06 I07 I08 I09 I10 I11 B17
    B07 I12 I13 I14 I15 I16 B13
        B15 I17 I18 I19 B05
            B19 B01 B09
```

## Detection output example
Detection output with (x, y) coordinates for a dataset sample `1619240573769481609.bin` and selected radii 2, 3, 4, and 5:

```txt
FIMD-CPU r=2: detected 12 markers, 364 sun points.
Markers: [(266,194),(257,318),(283,325),(221,354),(229,358),(520,382),(523,382),(515,384),(411,407),(379,415),(386,416),(374,416)]

FIMD-CPU r=3: detected 11 markers, 181 sun points.
Markers: [(266,194),(272,316),(257,317),(283,324),(221,354),(229,358),(520,382),(515,384),(379,415),(386,416),(374,416)]

FIMD-CPU r=4: detected 12 markers, 119 sun points.
Markers: [(266,194),(272,315),(256,317),(283,324),(221,354),(229,358),(520,382),(515,384),(412,407),(379,415),(386,416),(374,416)]

FIMD-CPU r=5: detected 11 markers, 82 sun points.
Markers: [(266,194),(272,315),(256,317),(283,324),(221,354),(229,358),(520,382),(515,384),(411,407),(379,415),(386,416)]
```